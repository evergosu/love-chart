var M=Object.defineProperty;var S=(u,e,t)=>e in u?M(u,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[e]=t;var n=(u,e,t)=>S(u,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&s(h)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();class C{constructor(e,t,s,i){n(this,"currentDay",0);n(this,"lastDay");this.man=e,this.woman=t,this.collision=s,this.lastDay=i}simulateDay(){this.woman.decay(this.currentDay),this.man.decay(this.currentDay),this.woman.changeEmotions(this.currentDay),this.collision.check(this.currentDay),this.collision.checkBreakup(this.currentDay),this.collision.brakeUpDay&&(this.man.retainDiscontent(),this.woman.retainDiscontent(),this.lastDay=Math.floor(this.collision.brakeUpDay*1.5)),this.woman.save(),this.man.save(),this.currentDay++}simulateLife(){for(;this.currentDay<this.lastDay;)this.simulateDay()}}class U{constructor(e,t){n(this,"bound","none");n(this,"startDay",0);n(this,"brokeUp",null);n(this,"brakeUpDay",null);this.man=e,this.woman=t}handleLower(e){this.woman.value>-this.man.value&&this.stop(e)<=2&&this.man.retainCapacity()}handleNone(e){this.woman.value>=this.man.value&&(this.start(e,"upper"),this.woman.addDiscontent()),this.woman.value>0&&this.man.resetDiscontent(),this.woman.value<=-this.man.value&&(this.start(e,"lower"),this.man.looseCapacity(),this.man.addDiscontent(),this.woman.resetDiscontent())}handlePersistentNeglect(){this.woman.value<-this.man.capacity/3&&this.man.isRageFromDiscontent()?this.man.looseCapacity():this.man.addDiscontent()}handleUpper(e){this.woman.value<this.man.value&&this.stop(e)>=2&&this.woman.hate()}shouldCollide(e){return e>this.man.decayDuration&&e>this.woman.decayDuration}start(e,t){this.bound=t,this.startDay=e}stop(e){const t=e-this.startDay;return this.bound="none",this.startDay=0,t}check(e){if(this.shouldCollide(e))switch(this.handlePersistentNeglect(),this.bound){case"none":this.handleNone(e);break;case"upper":this.handleUpper(e);break;case"lower":this.handleLower(e);break}}checkBreakup(e){if(this.brakeUpDay!=null)return;const t=this.man.value<Math.floor(this.man.capacity/3);(this.woman.value<-this.man.capacity*.8||t)&&(this.brakeUpDay=e,this.brokeUp=t?"man":"woman")}}class x{constructor(e,t,s){n(this,"decayDuration");n(this,"decayStep");n(this,"discontent",0);n(this,"history",[]);this.value=e,this.thoughts=t;const[i,a]=s;this.decayDuration=Math.floor(Math.random()*(a-i)+i),this.decayStep=50/this.decayDuration}addDiscontent(){this.discontent++}hate(){this.discontent+=10}isRageFromDiscontent(){const e=Math.min(this.discontent*5,50);return Math.random()*100<=e}save(){this.history.push(this.value)}resetDiscontent(){this.discontent=0}retainDiscontent(){}}class P extends x{constructor(t,s,i){super(t,B,s);n(this,"bigEmotionDay",30);n(this,"smallEmotionDay",14);n(this,"amplitude",50);this.value=t,this.initialManCapacity=i}emote(t){this.value+=t}getEmotionAmplitude(){return this.amplitude*(1+this.discontent*.05)}addDiscontent(){super.addDiscontent(),this.emote(-(Math.random()*10+10))}changeEmotions(t){if(t>this.decayDuration){const s=this.getEmotionAmplitude();t%this.bigEmotionDay===0?this.emote((Math.random()-.5)*s):(t%this.smallEmotionDay===0||this.isRageFromDiscontent())&&this.emote((Math.random()-.5)*(s/2)),this.value=Math.max(-this.initialManCapacity,Math.min(this.initialManCapacity,this.value))}}decay(t){if(t<=this.decayDuration){const s=(Math.random()-.5)*this.decayStep*5,i=Math.random()<.9?-1:1;this.value+=i*(this.decayStep+s)}}retainDiscontent(){this.discontent>0&&(this.discontent-=this.discontent*.9)}}const B=["Я чувствую себя любимой","Он — мой человек","С ним я могу быть собой","Мне спокойно рядом с ним","Я счастлива, что он рядом","Я люблю его всей душой","Он заботливый и внимательный","Мы — сильная пара","Я горжусь нашими отношениями","Он умеет меня поддержать","Я вижу в нём надёжность","Он делает меня лучше","Мы вместе растём","С ним легко и тепло","Я могу ему доверять","Он слушает и слышит меня","Мне нравится, как он смотрит на меня","Он уважает мои границы","Я чувствую себя нужной","Он вдохновляет меня","Я благодарна за него","С ним жизнь полна смысла","Он заботится о моих чувствах","Мы дополняем друг друга","Он делает меня счастливой","С ним я смеюсь от души","Я чувствую себя красивой рядом с ним","Он интересуется моим мнением","Мы делаем шаги навстречу","Он умеет мириться первым","Он принимает мою уязвимость","Он замечает мелочи","Я могу говорить с ним о чём угодно","Он рядом, когда мне плохо","Мы вместе преодолеваем трудности","Он даёт мне свободу","Я уверена в нём","Я чувствую тепло его слов","Он разделяет мои ценности","Мы вместе создаём уют","Он старается ради нас","Иногда я устаю, но я всё равно его люблю","Я хочу большего понимания","Иногда он не слышит, но я стараюсь объяснить","Я скучаю по романтике","Мы немного отдалились","Я чувствую себя не до конца понятой","Мне не хватает искренности","Иногда он холоден","Я хочу, чтобы он был ближе","Я держу многое в себе","Я не всегда чувствую его участие","Он стал меньше интересоваться мной","Я скучаю по тем временам","Я не знаю, что он чувствует","Мне тяжело говорить о своих желаниях","Иногда я чувствую одиночество рядом с ним","Я устаю от равнодушия","Я чувствую дистанцию","Он будто не замечает моих эмоций","Мне не хватает разговоров","Я стараюсь — он молчит","Я начинаю сомневаться","Я не уверена в его чувствах","Он стал чужим","Я чувствую себя ненужной","Мне больно от его слов","Он всё чаще раздражается","Я боюсь показаться слабой","Иногда я не узнаю его","Мне кажется, я больше вкладываюсь","Я не чувствую отклика","Мне тяжело быть рядом","Я теряю себя в этих отношениях","Он отдаляется всё больше","Я чувствую вину за всё","Я плачу в одиночку","Я устала бороться","Он меня не слышит","Я чувствую себя неценной","Мы как соседи","Я боюсь признаться в своих мыслях","Я не чувствую любви","Я держусь из последних сил","Иногда я мечтаю исчезнуть","Мне страшно остаться, но страшнее уйти","Я больше не верю в нас","Я будто пустая внутри","Я не хочу больше надеяться","Он как будто рядом и не рядом","Я устала молчать","Я не знаю, кто я рядом с ним","Я чувствую конец","Я больше не могу притворяться","Всё, что было, исчезло","Я чувствую, как исчезаю","Я не вижу смысла","Мне больно от воспоминаний","Я уже мысленно прощаюсь","Я сломлена","Я хочу уйти","Я больше его не люблю","Я чувствую только пустоту","Это конец"];class E extends x{constructor(t,s){super(t,L,s);n(this,"resilience",0);n(this,"rancor",.9);this.capacity=t}decay(t){if(t<=this.decayDuration){const s=t/this.decayDuration;this.value=this.capacity-s**2*(this.capacity-100)}}looseCapacity(){this.resilience++,this.value*=this.rancor}retainCapacity(){this.value*=1+.03*this.resilience}retainDiscontent(){this.discontent>0&&(this.discontent-=this.discontent*.5)}}const L=["Я люблю её всем сердцем","Мы созданы друг для друга","С ней я чувствую себя дома","Каждый момент с ней — подарок","Я счастлив рядом с ней","Она — моя опора","Я горжусь нашими отношениями","С каждым днём я люблю её больше","Она вдохновляет меня","Мы — идеальная пара","Я чувствую её любовь","Она делает меня лучше","Мы понимаем друг друга без слов","Я доверяю ей полностью","Мне спокойно рядом с ней","Я скучаю по ней, даже когда она рядом","Мы всегда на одной волне","С ней я становлюсь мягче","Она заботится обо мне","Я хочу быть с ней всегда","Мы поддерживаем друг друга","Я ценю её искренность","Наши мечты совпадают","Она делает мою жизнь ярче","Мне легко с ней говорить","Мы умеем смеяться вместе","С ней я чувствую себя живым","Она понимает меня с полуслова","Наши сердца бьются в унисон","Я чувствую себя нужным","Я благодарен за неё","Мы учимся друг у друга","Она даёт мне силы","С ней я не боюсь будущего","Я уважаю её мнение","Мне нравится слушать её","С ней всё становится возможным","Я доверяю нашему пути","Она — моя лучшая подруга","Я чувствую гармонию","Мы умеем мириться","Я замечаю, как она меняется","Иногда сложно, но я знаю, зачем мы вместе","Я стараюсь её понять","Я не всегда прав","Нам нужно больше времени вместе","Я устал, но она важна для меня","Иногда мне нужно побыть одному","Мы часто спорим в последнее время","Я чувствую напряжение","Иногда я не понимаю её","Меня раздражают мелочи","Я боюсь, что отдаляюсь","Я чувствую себя одиноким рядом с ней","Я скучаю по тому, как было раньше","Мне не хватает её тепла","Я начинаю сомневаться","Мы как будто говорим на разных языках","Иногда мне кажется, что я ей безразличен","Я не знаю, как ей это сказать","Я держу всё в себе","Я чувствую, что нас что-то разделяет","Я всё чаще молчу","Я устаю от ссор","Я не узнаю её","Я чувствую пустоту","Мне тяжело рядом с ней","Я чувствую себя виноватым","Мы как чужие","Я не чувствую поддержки","Мне кажется, я больше стараюсь","Я боюсь быть собой","Она отдаляется","Я не знаю, любит ли она меня","Я чувствую себя неважным","Мы слишком разные","Я чувствую безысходность","Я не хочу идти домой","Мне страшно говорить правду","Я думаю, что это конец","Я не чувствую любви","Я не вижу будущего","Мы просто вместе по привычке","Она больше не улыбается мне","Мне кажется, я один в этих отношениях","Я устал пытаться","Я чувствую, что теряю себя","Иногда я хочу всё бросить","Я не верю в нас","Мне больно от её молчания","Я не знаю, зачем мы вместе","Я чувствую, как умирает любовь","Я больше не могу","Всё потеряло смысл","Я чувствую конец","Я уже прощаюсь с ней в мыслях","Я сломлен","Я пуст внутри","Я хочу уйти","Я не люблю её больше","Я чувствую только боль","Это был конец"];class k{constructor(e){n(this,"ctx");n(this,"logicalHeight",0);n(this,"logicalWidth",0);n(this,"scale",1);n(this,"mapX",e=>e);this.canvas=e,this.ctx=e.getContext("2d"),this.adaptCanvasToContainer(e)}adaptCanvasToContainer(e){this.resize=this.resize.bind(this),this.resize(),new ResizeObserver(this.resize).observe(e)}resize(){const e=window.devicePixelRatio||1,t=this.canvas.getBoundingClientRect(),s=Math.floor(t.width*e),i=Math.floor(t.height*e);(this.canvas.width!==s||this.canvas.height!==i)&&(this.canvas.width=s,this.canvas.height=i,this.logicalWidth=t.width,this.logicalHeight=t.height,this.ctx.setTransform(1,0,0,1,0,0),this.ctx.scale(e,e))}mapY(e){return this.logicalHeight/2-e*this.scale}drawCanvas(e,t,s){this.ctx.clearRect(0,0,this.logicalWidth,this.logicalHeight),this.mapX=i=>(i-e)/t*this.logicalWidth,this.scale=this.logicalHeight/2*.8/s,this.ctx.lineWidth=2*this.scale}}class X extends k{constructor(e){super(e)}drawAxis(){this.ctx.strokeStyle="#888",this.ctx.beginPath(),this.ctx.moveTo(0,this.mapY(0)),this.ctx.lineTo(this.logicalWidth,this.mapY(0)),this.ctx.stroke()}drawBlueTunnel(e,t,s){this.ctx.fillStyle="rgba(100, 149, 237, 0.2)",this.ctx.beginPath(),this.ctx.moveTo(this.mapX(t),this.mapY(e[t]));for(let i=t;i<=s;i++)this.ctx.lineTo(this.mapX(i),this.mapY(e[i]));for(let i=s;i>=t;i--)this.ctx.lineTo(this.mapX(i),this.mapY(-e[i]));this.ctx.closePath(),this.ctx.fill()}drawGrayTunnel(e,t,s){this.ctx.fillStyle="rgba(160, 160, 160, 0.2)",this.ctx.beginPath(),this.ctx.moveTo(this.mapX(t),this.mapY(e[t]));for(let i=t;i<=s;i++)this.ctx.lineTo(this.mapX(i),this.mapY(e[i]));for(let i=s;i>=t;i--)this.ctx.lineTo(this.mapX(i),this.mapY(-e[i]));this.ctx.closePath(),this.ctx.fill()}drawTunnel(e,t,s,i,a){const h=Math.max(i,0),r=t.brakeUpDay!=null&&t.brakeUpDay<s?t.brakeUpDay:Math.min(s,i+a);if(this.drawBlueTunnel(e,h,r),t.brakeUpDay!=null){const o=Math.max(i,t.brakeUpDay);this.drawGrayTunnel(e,o,s)}}drawRedLine(e,t,s){this.ctx.beginPath(),this.ctx.strokeStyle="#ff4f8b",this.ctx.moveTo(this.mapX(t),this.mapY(e[t])),t&&this.ctx.moveTo(this.mapX(t),this.mapY(e[t]));for(let i=t;i<=s;i++)this.ctx.lineTo(this.mapX(i),this.mapY(e[i]));this.ctx.stroke()}drawGrayLine(e,t,s){this.ctx.beginPath(),this.ctx.strokeStyle="#aaa";let i=0,a=e[t],h=!1;this.ctx.moveTo(this.mapX(t),this.mapY(a));for(let r=t;r<s;r++){const o=e[r];h?this.ctx.lineTo(this.mapX(r),this.mapY(i)):((o===0||o*a<0)&&(h=!0,i=o),this.ctx.lineTo(this.mapX(r),this.mapY(o)),a=o)}this.ctx.stroke()}drawWomanLine(e,t,s,i,a){const h=Math.max(i,0),r=t.brakeUpDay!=null&&t.brakeUpDay<s?t.brakeUpDay:Math.min(s,i+a);this.drawRedLine(e,h,r),t.brakeUpDay!=null&&s>t.brakeUpDay&&this.drawGrayLine(e,r,s)}drawMarker(e,t,s){const i=this.mapX(e),a=this.mapY(t);this.ctx.save(),this.ctx.fillStyle="#000",this.ctx.font="24px sans-serif",this.ctx.textAlign="center",this.ctx.fillText("✂️",i,this.mapY(-10)),this.ctx.beginPath(),this.ctx.moveTo(i,this.mapY(0)),this.ctx.lineTo(i,a),this.ctx.strokeStyle="#000",this.ctx.stroke(),this.ctx.fillText(s,i,a),this.ctx.restore()}drawBreakup(e,t,s,i){if(s.brakeUpDay!=null&&i>=s.brakeUpDay){const a=s.brokeUp==="man",h=a?-e[s.brakeUpDay]:t[s.brakeUpDay],r=a?"♂️":"♀️";this.drawMarker(s.brakeUpDay,h,r)}}draw(e,t,s,i,a,h,r){this.drawCanvas(a,h,r),this.drawAxis(),this.drawTunnel(e,s,i,a,h),this.drawWomanLine(t,s,i,a,h),this.drawBreakup(e,t,s,i)}}class A extends k{constructor(t){super(t);n(this,"currentSpacing",0);n(this,"offset",0);n(this,"manThought","");n(this,"womanThought","")}drawCharacter(t,s,i){const o=this.logicalHeight/2-50*this.scale;this.offset=o,this.ctx.save(),this.ctx.strokeStyle=i,this.ctx.fillStyle=i,this.ctx.lineWidth=8,this.ctx.beginPath(),this.ctx.moveTo(t,o),this.ctx.lineTo(t,o+40),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(t-20,o+40/2),this.ctx.lineTo(t+20,o+40/2),this.ctx.stroke();const f=o+40;this.ctx.beginPath(),this.ctx.moveTo(t,f),this.ctx.lineTo(t-20,f+20),this.ctx.moveTo(t,f),this.ctx.lineTo(t+20,f+20),this.ctx.stroke(),this.ctx.font="42px serif",this.ctx.textAlign="center",this.ctx.fillText(s,t,o+5),this.ctx.restore()}getEmoji(t,s,i){return s.brakeUpDay&&i>=s.brakeUpDay?"😐":i<t.decayDuration||t.history[i]>100?"😍":t.history[i]>80?"😊":t.history[i]<60?"🥺":t.history[i]<0?"😡":t.discontent>20?"😭":t.discontent>10?"😡":t.discontent>5?"😕":"😐"}drawSpeechBubble(t,s,i,a,h,r){t.font="14px sans-serif";const d=t.measureText(s).width+10*2,p=this.logicalWidth,m=6;let c=i-d/2;r?(c+=80,c+d>p-m&&(c=p-m-d),c<m&&(c=m)):(c-=80,c<m&&(c=m),c+d>p-m&&(c=p-m-d));const l=h==="up"?a-24-10:a+10,g=c+d/2;t.beginPath(),t.moveTo(c+10,l),t.lineTo(c+d-10,l),t.quadraticCurveTo(c+d,l,c+d,l+10),t.lineTo(c+d,l+24-10),t.quadraticCurveTo(c+d,l+24,c+d-10,l+24),t.lineTo(c+10,l+24),t.quadraticCurveTo(c,l+24,c,l+24-10),t.lineTo(c,l+10),t.quadraticCurveTo(c,l,c+10,l),t.closePath(),t.fillStyle="rgba(0,0,0,0.7)",t.fill(),t.beginPath(),t.moveTo(i,this.offset-20),h==="up"?(t.lineTo(g-6,l+24),t.lineTo(g+6,l+24)):(t.lineTo(g-6,l),t.lineTo(g+6,l)),t.closePath(),t.fill(),t.fillStyle="white",t.textAlign="center",t.textBaseline="middle",t.fillText(s,g,l+24/2)}draw(t,s,i,a,h,r){this.drawCanvas(0,h,r);const o=Math.max(0,Math.min(a,t.history.length-1,s.history.length-1));this.ctx.clearRect(0,0,this.logicalWidth,this.logicalHeight);const f=this.logicalWidth*.8,w=Math.abs(s.history[o]-t.history[o])*2,y=Math.min(w,f),d=this.logicalWidth/2,p=.1;this.currentSpacing+=(y-this.currentSpacing)*p;const m=d-this.currentSpacing/2,c=d+this.currentSpacing/2;if(this.drawCharacter(m,this.getEmoji(t,i,o),"#4682B4"),this.drawCharacter(c,this.getEmoji(s,i,o),"#FF69B4"),a%30===0){const l=Math.floor(Math.random()*100)-5;this.manThought=t.thoughts.at(l)??"",this.womanThought=s.thoughts.at(l)??""}this.manThought&&this.drawSpeechBubble(this.ctx,this.manThought,m,this.offset-20,"up",!1),this.womanThought&&this.drawSpeechBubble(this.ctx,this.womanThought,c,this.offset-50,"up",!0)}}class I{constructor(){n(this,"currentDay");n(this,"brakeUpDay");n(this,"brokeUp");this.currentDay=document.getElementById("current-day"),this.brokeUp=document.getElementById("broke-up"),this.brakeUpDay=document.getElementById("brake-up-day")}formatDuration(e){const t=Math.floor(e/365),s=Math.floor(e%365/30),i=Math.floor(e%30);return`${t.toString().padStart(2,"0")}y ${s.toString().padStart(2,"0")}m ${i.toString().padStart(2,"0")}d`}updateCurrentDay(e){this.currentDay.textContent=typeof e=="number"?this.formatDuration(e):e}updateBrakeUpDay(e){this.brakeUpDay.textContent=typeof e=="number"?this.formatDuration(e):e}updateBrokeUp(e){this.brokeUp.textContent=typeof e=="number"?this.formatDuration(e):e}}class Y{constructor(){n(this,"newAtMaxButton");n(this,"newAtMax");n(this,"down");n(this,"up");this.up=document.getElementById("speed-up"),this.down=document.getElementById("speed-down"),this.newAtMax=document.getElementById("new-at-max"),this.newAtMaxButton=document.getElementById("new-at-max-button"),this.newAtMaxButton.onclick=()=>window.location.reload()}updateNewAtMax(e){this.newAtMax.textContent=e.toString()}}class R{constructor(e,t,s,i,a,h){n(this,"currentDay",0);n(this,"frameId",null);n(this,"graph");n(this,"isPlaying",!1);n(this,"lastTickTime",performance.now());n(this,"scene");n(this,"timeline");n(this,"info",new I);n(this,"controls",new Y);n(this,"refreshRate",60);this.man=e,this.woman=t,this.collision=s,this.totalDays=i,this.daysPerSecond=a,this.frameDays=h,this.estimateRefreshRate(o=>{this.refreshRate=o,console.log("Estimated refresh rate:",o,"Hz")});const r=Number(window.localStorage.getItem("daysPerSecond"));r?this.daysPerSecond=r:this.daysPerSecond=a,this.tick=this.tick.bind(this),this.graph=new X(document.getElementById("graph")),this.scene=new A(document.getElementById("scene")),this.timeline=document.getElementById("timeline"),this.controls.up.onclick=()=>this.updateSpeed(10),this.controls.down.onclick=()=>this.updateSpeed(-10),this.setupCanvasDrag(document.getElementById("graph")),this.timeline.max=String(i),this.timeline.oninput=()=>{this.seek(Number(this.timeline.value))}}estimateRefreshRate(e,t=60,s=[60,120,144,165,240]){const i=[];let a=performance.now();function h(r){const o=r-a;if(a=r,i.push(o),i.length<t)requestAnimationFrame(h);else{const f=i.filter(p=>p>5&&p<100),y=1e3/(f.reduce((p,m)=>p+m,0)/f.length),d=s.reduce((p,m)=>Math.abs(m-y)<Math.abs(p-y)?m:p);e(d)}}requestAnimationFrame(h)}updateSpeed(e){const t=Math.max(0,this.daysPerSecond+e);this.daysPerSecond=t,window.localStorage.setItem("daysPerSecond",String(t))}setupCanvasDrag(e){let t=!1,s=0;const i=a=>{const h=a-s;s=a;const r=Math.max(1,this.frameDays),o=e.clientWidth/r,f=Math.round(h/o);this.seek(this.currentDay-f)};e.addEventListener("mousedown",a=>{t=!0,s=a.clientX,this.pause()}),window.addEventListener("mousemove",a=>{t&&i(a.clientX)}),window.addEventListener("mouseup",()=>{t=!1,this.play()}),e.addEventListener("touchstart",a=>{a.touches.length===1&&(t=!0,s=a.touches[0].clientX,this.pause())},{passive:!0}),window.addEventListener("touchmove",a=>{!t||a.touches.length!==1||(a.preventDefault(),i(a.touches[0].clientX))},{passive:!1}),window.addEventListener("touchend",()=>{t=!1,this.play()})}updateFrame(e){const t=Math.max(0,e-this.frameDays);this.graph.draw(this.man.history,this.woman.history,this.collision,Math.floor(e),Math.floor(t),this.frameDays,this.man.capacity),this.scene.draw(this.man,this.woman,this.collision,Math.floor(e)-1,this.frameDays,this.man.capacity),this.timeline.value=String(e),this.updateViews(e)}updateViews(e){this.info.updateCurrentDay(e);const t=this.collision.brakeUpDay&&e>=this.collision.brakeUpDay;this.info.updateBrokeUp(t?this.collision.brokeUp:"not yet"),this.info.updateBrakeUpDay(t?this.collision.brakeUpDay:"not yet"),this.controls.updateNewAtMax(this.daysPerSecond)}play(){this.isPlaying||(this.isPlaying=!0,this.lastTickTime=performance.now(),this.frameId=requestAnimationFrame(e=>this.tick(e)))}pause(){this.frameId&&cancelAnimationFrame(this.frameId),this.isPlaying=!1}stop(){this.pause(),this.currentDay=0,this.frameId=null,this.lastTickTime=performance.now()}forward(e=10){this.pause(),this.currentDay=Math.min(this.totalDays,this.currentDay+e),this.lastTickTime=performance.now(),this.updateFrame(this.currentDay)}rewind(e=10){this.pause(),this.currentDay=Math.max(0,this.currentDay-e),this.lastTickTime=performance.now(),this.updateFrame(this.currentDay)}seek(e){this.pause();const t=Math.max(0,Math.min(this.totalDays,e));this.currentDay=t,this.lastTickTime=performance.now(),this.updateFrame(this.currentDay)}tick(e){if(!this.isPlaying)return;const t=(e-this.lastTickTime)/1e3;if(t<1/this.refreshRate){this.frameId=requestAnimationFrame(this.tick);return}if(this.lastTickTime=e,this.currentDay+=t*this.daysPerSecond,this.currentDay>=this.totalDays){this.currentDay=this.totalDays,this.updateFrame(this.currentDay),this.pause();return}this.updateFrame(this.currentDay),this.frameId=requestAnimationFrame(this.tick)}}const D=new E(150,[14,90]),b=new P(150,[14,90],D.value),T=new U(D,b),F=100*365,v=new C(D,b,T,F);v.simulateLife();const W=new R(D,b,T,v.lastDay,30,365);W.play();
